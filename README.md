# Food-Delivery-Application-Order-Analysis

# Problem Statement

Zomato, a leading online food delivery platform, is planning to introduce a premium membership for customers who have placed multiple orders in a single day. Write a SQL query to identify these customers and calculate the total order value generated by them as well as the order value generated only by those orders.

![Day27](https://github.com/bhumikadata/Food-Delivery-App.-Order-Analysis/assets/131578649/5297906e-995b-4dcd-b15c-76448807decf)

# SQL Code

```
-- Common Table Expression to identify customers who have placed multiple orders on a single day
WITH cte1 AS (
    SELECT 
        customer_name,
        strftime('%Y-%m-%d', order_date) AS order_day,
        COUNT(DISTINCT order_id) AS no_of_orders
    FROM 
        orders 
    GROUP BY 
        customer_name,
        order_day
    HAVING 
        COUNT(DISTINCT order_id) > 1
)
-- Main query to calculate total order value and order value only for customers with multiple orders in a day
SELECT
    o.customer_name,
    SUM(o.order_value) AS total_order_value,
    SUM(CASE WHEN c.customer_name IS NOT NULL THEN o.order_value END) AS order_value
FROM 
    orders o
LEFT JOIN 
    cte1 c
ON 
    strftime('%Y-%m-%d', o.order_date) = c.order_day
    AND o.customer_name = c.customer_name  
WHERE 
    o.customer_name IN (SELECT DISTINCT customer_name FROM cte1)
GROUP BY 
    o.customer_name;
```

# Explanation

- The SQL query begins with a Common Table Expression (CTE) named cte1, which identifies customers who have placed multiple orders on a single day. This is achieved by grouping orders by customer_name and order_day, and then filtering out those with more than one order using the HAVING clause.

- In the main query, we select the customer name and calculate two aggregates:

  - total_order_value: The total order value for each customer.

  - order_value: The order value generated only by those orders where the customer has placed multiple orders in a single day. This is achieved using a CASE statement within the SUM function, ensuring that only 
                 orders meeting the condition are summed up.
    
- We use a LEFT JOIN between the orders table and the CTE cte1 on the condition that the order date and customer name match, ensuring that all orders are retained in the result set.

- Finally, we filter the results using a WHERE clause to include only those customers who have placed multiple orders in a single day.

  # Result 

This SQL query is useful for Zomato to identify customers who frequently place multiple orders in a single day, helping them in targeting these customers for their premium membership program. By calculating the total order value and the order value generated only by these orders, Zomato can gain insights into the spending behavior of these customers and tailor their premium membership offerings accordingly.


